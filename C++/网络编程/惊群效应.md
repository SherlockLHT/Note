https://www.cnblogs.com/Anker/p/7071849.html

# 1、前言

从事了很多年客户端的开发，知道近一年多才涉及linux系统编程，发现相关的知识点甚是缺乏，学习不可停止啊。惊群效应也是近期学习多路复用之后才发现的，简单查了一些资料，大概明白了其中的原委，简单记录一下吧。

# 2、服务端的网络编程

因为我的服务端程序都是和设备通信，在对数据量以及并发要求不高的时候，我都是编写 tcp server 代码都是在一个线程中等待客户端的连接，发现一个连接后，创建一个线程并将客户端的 fd 放到线程中，再和客户端进行通信。

而当同一时间的短连接很多，只在一个线程中的accept就会成为业务的性能瓶颈，导致客户端的connect出现延时。

鉴于这种情况，出现了所谓多路复用的网路模型，并逐渐出现了多进程或者多线程的模型，最典型的就是 Nginx 的 Master-Worker 多进程异步驱动模型。它的思路就是，父进程在创建socket、bind、listen之后，创建很多子进程，并同时继承了父进程的 socket，这样，就会出现多个进程同时 accept 同一个 server fd 的情况，没有客户端连接的时候，这些进程都处于休眠状态，当有客户端连接的时候，这多个进程同时被唤醒，内核重新调度，让多个进程同时相应一个事件，但是最终，只有一个进程能处理事件成功，其他进程被唤醒，但是处理失败，继续休眠，这个现象叫做 **“惊群”**。惊群会导致资源的浪费，尤其是在高并发这种资源锱铢必较的情况下。